{% extends 'admin/statistics/dashboard.html.twig' %}

{% block date_range_form %}
	{% include 'admin/statistics/_form_date_range.html.twig' %}
{% endblock date_range_form %}

{% block stats_content %}
	<div id="acquisition-panel" class="fr-tabs__panel fr-tabs__panel--selected" role="tabpanel" aria-labelledby="acquisition" tabindex="0">
		<div class="d-flex">
			<div class="card col">
				<div class="card-body d-flex flex-column justify-content-between">
					<h5 class="card-title">
						<a class="card-link" href="#">EntrÃ©es directes</a>
					</h5>
					<p class="card-text fs-2">
						<strong>{{ statsMatomoReferer.Referrers_visitorsFromDirectEntry }}</strong>
					</p>
				</div>
			</div>
			<div class="card col">
				<div class="card-body d-flex flex-column justify-content-between">
					<h5 class="card-title">
						<a class="card-link" href="#">Depuis les moteurs</a>
					</h5>
					<p class="card-text fs-2">
						<strong>{{ statsMatomoReferer.Referrers_visitorsFromSearchEngines }}</strong>
					</p>
				</div>
			</div>
			<div class="card col">
				<div class="card-body d-flex flex-column justify-content-between">
					<h5 class="card-title">
						<a class="card-link" href="#">Depuis dâ€™autres sites</a>
					</h5>
					<p class="card-text fs-2">
						<strong>{{ statsMatomoReferer.Referrers_visitorsFromWebsites }}</strong>
					</p>
				</div>
			</div>
			<div class="card col">
				<div class="card-body d-flex flex-column justify-content-between">
					<h5 class="card-title">
						<a class="card-link" href="#">Depuis les newsletters</a>
					</h5>
					<p class="card-text fs-2">
						<strong>{{ statsMatomoReferer.Referrers_visitorsFromCampaigns }}</strong>
					</p>
				</div>
			</div>
			<div class="card col">
				<div class="card-body d-flex flex-column justify-content-between">
					<h5 class="card-title">
						<a class="card-link" href="#">Depuis les rÃ©seaux sociaux</a>
					</h5>
					<p class="card-text fs-2">
						<strong>{{ statsMatomoReferer.Referrers_visitorsFromSocialNetworks }}</strong>
					</p>
				</div>
			</div>
		</div>

		<h3 class="mt-5">
			<span aria-hidden="true">ðŸ§²
			</span>Principales sources dâ€™entrÃ©es sur la pÃ©riode ({{ dateMin|date('d/m/Y') }}â†’{{ dateMax|date('d/m/Y') }}) :</h3>
		<div class="alert alert-info">
			<p>EntrÃ©es sur le site en fonction du domaine, aucun regroupement nâ€™est fait sur les sous-domaines des listes de diffusion.</p>
			<p>La colonne excluant la recherche permet dâ€™avoir des Ã©carts rÃ©sultants dâ€™actions de lâ€™Ã©quipe plus significatifs.</p>
		</div>
		<div class="table-responsive mt-5">
			<table class="table table-striped dataTable">
				<caption>Principales sources dâ€™entrÃ©es</caption>
				<thead>
					<tr>
						<th scope="col">Domaine</th>
						<th scope="col">Visites</th>
						<th scope="col">Pourcentage</th>
						<th scope="col">Pourcentage (sans la recherche)</th>
					</tr>
				</thead>
				<tbody>
					{% for label, counts in referrers %}
						<tr>
							<td scope="row">{{ label }}</td>
							<td>
								{% if counts.nb_visits is defined %}
									{{ counts.nb_visits }}{% else %}-
								{% endif %}
							</td>
							<td>
								{% if counts.percentage_total is defined %}
									{{ counts.percentage_total }}{% else %}-
								{% endif %}
							</td>
							<td>
								{% if counts.percentage_without_search is defined %}
									{{ counts.percentage_without_search }}{% else %}-
								{% endif %}
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<h3 class="mt-5">
			<span aria-hidden="true">ðŸ™‹
			</span>Nouvelles inscriptions sur la pÃ©riode ({{ dateMin|date('d/m/Y') }}â†’{{ dateMax|date('d/m/Y') }}) :</h3>
		<div class="alert alert-info">
			<p>Flux des inscriptions avec une cadence hebdomadaire classique.</p>
		</div>

		<div class="charts">
			{{ render_chart(chartInscriptions) }}
		</div>

		<div class="alert alert-info">
			<p>Tableau de dÃ©tail des inscriptions sur la pÃ©riode.</p>
			<p>Cela permet dâ€™identifier si les pics correspondent Ã  des actions localisÃ©es par exemple.</p>
		</div>
		<div class="table-responsive mt-5">
			<table class="table table-striped dataTable">
				<caption>Nouvelles inscription sur la pÃ©riodes</caption>
				<thead>
					<tr>
						<th scope="col">Nom</th>
						<th scope="col">Courriel</th>
						<th scope="col">Date dâ€™inscription</th>
						<th scope="col">Organisation</th>
						<th scope="col">Type</th>
					</tr>
				</thead>
				<tbody>
					{% for user in userRegisters %}
						<tr>
							<td scope="row">{{ user.firstname }}{{ user.lastname }}</td>
							<td>{{ user.email }}</td>
							<td>{{ user.dateCreate|date('d/m/Y') }}</td>
							<td>
								{% if user.defaultOrganization %}
									{{ user.defaultOrganization.name }}
								{% endif %}
							</td>
							<td>
								{% if user.defaultOrganization and user.defaultOrganization.organizationType %}
									{{ user.defaultOrganization.organizationType }}
								{% endif %}
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>

{% endblock stats_content %}
