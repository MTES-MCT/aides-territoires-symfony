{% if aids %}
<div class="fr-table {% if forceDisplayAidAsList is not defined %}at-display__none{% endif %}" id="aids-as-list">
    <table>
        <caption class="fr-sr-only">Liste des aides</caption>
        <thead>
            <tr>
                <th scope="col">Nom</th>
                <th scope="col">Porteurs</th>
                <th scope="col">Périmètre</th>
                <th scope="col">Subvention</th>
                <th scope="col">Prêt</th>
                <th scope="col">Ingénierie</th>
                <th scope="col">Echéance</th>
            </tr>
        </thead>
        <tbody>
        {% for aid in aids %}
            {% set aidUrlParams = {'slug': aid.slug} %}
            {% if integration is defined %}
                {% set aidUrlParams = aidUrlParams|merge({'integration': 'integration'}) %}
            {% endif %}
            <tr>
                <td  class="highlightable">
                    <a href="{{ path('app_aid_aid_details', {'slug': aid.slug}) }}{% if integration is defined %}?integration=integration{% endif %}">
                    {{ aid.name }} {% if app.user and app.user and isUserGranted(app.user, constant('App\\Entity\\User\\User::ROLE_ADMIN')) %}(st: {{ aid.scoreTotal}}, so: {{ aid.scoreObjects}}){% endif %}
                    </a>
                    {% if aid.isProjectReferencesAssociated %}
                    <div class="badge-aid-associated"><span class="fr-icon-thumb-up-fill fr-icon--sm" aria-hidden="true" title="Cette aide est associé au projet référent que vous recherchez"></span></div>
                    {% endif %}
                </td>
                <td>
                    {% if aid.aidFinancers %}
                    <ul>
                    {% set maxDisplay = 3 %}
                    {% set totalFinancers = aid.aidFinancers|length %}
                    {% for financer in aid.aidFinancers|slice(0, maxDisplay) %}
                        <li>
                            {{ financer.backer.name }}
                            {% if financer.backer.isCorporate %}
                                (Privé)
                            {% endif %}
                        </li>
                    {% endfor %}
                    {% if totalFinancers > maxDisplay %}
                        <li>+{{ totalFinancers - maxDisplay }} autres</li>
                    {% endif %}
                    </ul>
                {% endif %}
                </td>
                <td>
                    {% if aid.perimeter %}{{ aid.perimeter.name|u.truncate(40, '...') }}{% endif %}
                </td>
                <td>
                    {% if aid.isGrant %}
                    <p class="at-centered fr-mb-0">
                        <p class="fr-badge fr-badge--success">Oui</p>
                    </p>
                    {% endif %}
                </td>
                <td>
                    {% if aid.isLoan %}
                    <p class="at-centered fr-mb-0">
                        <p class="fr-badge fr-badge--success">Oui</p>
                    </p>
                    {% endif %}
                </td>
                <td>
                    {% if aid.isTechnical %}
                    <p class="at-centered fr-mb-0">
                        <p class="fr-badge fr-badge--success">Oui</p>
                    </p>
                    {% endif %}
                </td>
                <td>
                    {% if aid.hasCalendar %}
                        {% if aid.dateSubmissionDeadline %}
                            {{ aid.dateSubmissionDeadline|date('d/m/y') }}
                        {% endif %}
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
